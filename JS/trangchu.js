////////////////////////////////////// tim kiem

let sach1 = { hinhanh: "../IMG/img-khoahoc/hh1.png", theloai: "Khoa học", ten: "Bảng tuần hoàn Hoá Học - The Periodic Table", tacgia: "Nhà xuất bản Lao Động", masach: 1, gia: "350.000" };
let sach2 = { hinhanh: "../IMG/img-khoahoc/sh1.jpg", theloai: "Khoa học", ten: "Nguồn Gốc Các Loài", tacgia: "Charles Darwin", masach: 2, gia: "150.000" };
let sach3 = { hinhanh: "../IMG/img-khoahoc/vl1.jpg", theloai: "Khoa học", ten: "Lược Sử Vạn Vật", tacgia: "Bill Byson", masach: 3, gia: "200.000" };
let sach4 = { hinhanh: "../IMG/img-khoahoc/kh1.png", theloai: "Khoa học", ten: "Bách Khoa Toàn Thư Không Gian", tacgia: "Nhà xuất bản Lao Động", masach: 4, gia: "450.000" };

let sach5 = { hinhanh: "../IMG/img-SGK/sach7.jpg", theloai: "Sách giáo khoa", ten: "Sách Giáo Khoa Bộ Lớp 7 - Sách Bài Học (Bộ 12 Cuốn)", tacgia: "Nhà Xuất Bản Giáo Dục", masach: 5, gia: "130.000" };
let sach6 = { hinhanh: "../IMG/img-SGK/sach8.jpg", theloai: "Sách giáo khoa", ten: "Sách Giáo Khoa Bộ Lớp 8 - Sách Bài Học (Bộ 12 Cuốn)", tacgia: "Nhà Xuất Bản Giáo Dục", masach: 6, gia: "140.000" };
let sach7 = { hinhanh: "../IMG/img-SGK/sach9.jpg", theloai: "Sách giáo khoa", ten: "Sách Giáo Khoa Bộ Lớp 9 - Sách Bài Học (Bộ 12 Cuốn)", tacgia: "Nhà Xuất Bản Giáo Dục", masach: 7, gia: "150.000" };
let sach8 = { hinhanh: "../IMG/img-SGK/sach10.jpg", theloai: "Sách giáo khoa", ten: "Sách Giáo Khoa Bộ Lớp 10 - Sách Bài Học (Bộ 14 Cuốn)", tacgia: "Nhà Xuất Bản Giáo Dục", masach: 8, gia: "160.000" };

let sach9 = { hinhanh: "../IMG/img-tapchi/amthuc.jpg", theloai: "Tạp chí", ten: "Delicious Magazine", tacgia: "Web Magazine", masach: 9, gia: "300.000" };
let sach10 = { hinhanh: "../IMG/img-tapchi/NG.jpg", theloai: "Tạp chí", ten: "National Geographic", tacgia: "Susan Goldberg", masach: 10, gia: "500.000" };
let sach11 = { hinhanh: "../IMG/img-tapchi/JUMP.jpg", theloai: "Tạp chí", ten: "Weekly Shōnen Jump", tacgia: "Yoshihisa Heishi", masach: 11, gia: "200.000" };
let sach12 = { hinhanh: "../IMG/img-tapchi/elle.jpg", theloai: "Tạp chí", ten: "Elle", tacgia: "Lorraine Candy", masach: 12, gia: "150.000" };

let sach13 = { hinhanh: "../IMG/img-novel/HP.jpg", theloai: "Tiểu thuyết", ten: "Harry Potter", tacgia: "J. K. Rowling", masach: 13, gia: "1.500.000" };
let sach14 = { hinhanh: "../IMG/img-novel/VH.jpg", theloai: "Tiểu thuyết", ten: "Những Người Khốn Khổ", tacgia: "Victor Hugo", masach: 14, gia: "1.200.000" };
let sach15 = { hinhanh: "../IMG/img-novel/3k.jpg", theloai: "Tiểu thuyết", ten: "Tam Quốc Diễn Nghĩa", tacgia: "La Quán Trung", masach: 15, gia: "1.400.000" };
let sach16 = { hinhanh: "../IMG/img-novel/SH.jpg", theloai: "Tiểu thuyết", ten: "Sherlock Holmes", tacgia: "Arthur Conan Doyle", masach: 16, gia: "1.300.000" };

let sach17 = { hinhanh: "../IMG/img-truyentranh/SL.jpg", theloai: "Truyện tranh", ten: "Solo Leveling", tacgia: "Chugong", masach: 17, gia: "80.000" };
let sach18 = { hinhanh: "../IMG/img-truyentranh/US.jpg", theloai: "Truyện tranh", ten: "Marvel Comics", tacgia: "John Nee, Stan Lee", masach: 18, gia: "90.000" };
let sach19 = { hinhanh: "../IMG/img-truyentranh/JP.jpg", theloai: "Truyện tranh", ten: "Doraemon", tacgia: "Fujiko Fujio", masach: 19, gia: "20.000" };
let sach20 = { hinhanh: "../IMG/img-truyentranh/VN.jpg", theloai: "Truyện tranh", ten: "Thần Đồng Đất Việt", tacgia: "Lê Linh", masach: 20, gia: "50.000" };

let sach21 = { hinhanh: "../IMG/img-sale/tho.png", theloai: "Giảm giá", ten: "Thỏ Bảy Màu Và Những Người Nghĩ Nó Là Bạn", tacgia: "Huỳnh Thái Ngọc", masach: 21, gia: "95.000" };
let sach22 = { hinhanh: "../IMG/img-sale/MK.png", theloai: "Giảm giá", ten: "Muôn Kiếp Nhân Sinh 2", tacgia: "Nguyên Phong", masach: 22, gia: "96.000" };
let sach23 = { hinhanh: "../IMG/img-sale/cam.png", theloai: "Giảm giá", ten: "Thời Kỳ Hậu Corona: Luôn Có Cơ Hội Trong Khủng Hoảng", tacgia: "Scott Galloway", masach: 23, gia: "97.000" };
let sach24 = { hinhanh: "../IMG/img-sale/body.png", theloai: "Giảm giá", ten: "How The Body Works - Hiểu Hết Về Cơ Thể", tacgia: "Nhã Nam", masach: 24, gia: "99.000" };

let dsSach = [sach1, sach2, sach3, sach4, sach5, sach6, sach7, sach8, sach9, sach10, sach11, sach12, sach13, sach14, sach15, sach16, sach17, sach18, sach19, sach20, sach21, sach22, sach23, sach24];
let i = 0;

function napSach(sach) {
    let row = "<tr align='center' height='100px'>" +
        "<td width='70px'>" +
        (i++) +
        "</td>" +
        "<td><img class='img-fluid' src=" +
        sach.hinhanh +
        "></a></td>" +
        "<td width='190px'>" +
        sach.theloai +
        "</td>" +
        " <td>" +
        "<h3>" + sach.ten + "</h3>" +
        "<p style='color: gray'>" +
        sach.tacgia + "<br>" +
        "<i>Mã sách:</i>	&nbsp; <span>" + sach.masach + "</span>" +
        "</p>" +
        "<input id='nutchitiet1' style='background: black; color: greenyellow' class='btn' type='button' value='Xem chi tiết' data-toggle='modal' data-target='#modalChiTiet1'>" + "<br><br>" +
        "<h4 style='color: red'><b>Giá: " + sach.gia + " <u>đ</u></b></h4>" +
        "</td>" +
        "</tr>"

    $('#myTable').append(row);
    // document.getElementById('#myTable').appendChild(row);

}
dsSach.forEach(napSach);

function ktTimKiem() {
    let ma = document.getElementById("txtTim").value;
    let regexMasach = /^\d+(\.\d+)?$/;
    // location.replace("../HTML/timKiem.html");

    if (ma.trim() === '' && !regexMasach.test(ma)) {
        document.getElementById("timkiem").innerHTML = "Mã sách định dạng là số ! &nbsp";
        dsSach.forEach(napSach);

        return false;
    }


    if (ma.trim() !== '' && regexMasach.test(ma)) {
        // document.getElementById("timkiem").innerHTML = "Mã sách định dạng là số  &nbsp";
        // // location.replace("../HTML/timKiem.html");
        // dsSach.indexOf(napSach(masach));
        // // napSach(sach);
        // return true;

        masach = parseInt(ma);
        let sachT = dsSach.findIndex(sachTemp => sachTemp.ma == masach);
        if (sachT == null) {
            document.getElementById("timkiem").innerHTML = "Không tìm thấy !";
            document.getElementById("myTable").innerHTML = "";
            return false;
        }
        //if(sach != null){
        //location.replace("../HTML/timKiem.html");
        // location.replace("../HTML/timKiem.html");

        if (sachT !== null) {
            document.getElementById("timkiem").innerHTML = "Đã tìm thấy !";
            document.getElementById("myTable").innerHTML = "";
            napSach(sachT);
            dsSach.forEach(napSach);
        }

    }

    return true;
    //}
}


//////////////////////////////////////////////////////////////////////////      regex dang nhap, dang ky
function ktTenAccDN() {
    let nameacc = document.getElementById("txtTenDN").value;
    if (nameacc.trim() === '') {
        document.getElementById("spTenDN").innerHTML = "Tên tài khoản đăng nhập không được trống !";
        return false;
    }
    // if (nameacc != document.getElementById("txtTK").value) {
    //     document.getElementById("spTenDN").innerHTML = "Sai tên đăng nhập !";
    //     return false;
    // }
    document.getElementById("spTenDN").innerHTML = "";

    //document.getElementById("spTenDN").innerHTML = "✅";
    return true;
}

function ktMKDN() {
    let pass = document.getElementById("pw").value;
    let regexPass = /^\s*[a-zA-Z0-9,\s]+\s*$/;
    if (pass.trim() === '') {
        document.getElementById("spPass").innerHTML = "Mật khẩu không được trống !";
        return false;
    }
    if (!regexPass.test(pass)) {
        document.getElementById("spPass").innerHTML = "Mật khẩu không chứa kí tự đặc biệt: {}[]()^$.|*+?\-";
        return false;
    }

    // if (pass != document.getElementById("pwDK").value) {
    //     document.getElementById("spPass").innerHTML = "Sai mật khẩu !";
    //     return false;
    // }
    document.getElementById("spPass").innerHTML = "";
    // alert("Đăng nhập thành công !");

    //document.getElementById("spPass").innerHTML = "✅";
    return true;
}

document.getElementById("txtTenDN").onblur = ktTenAccDN;
document.getElementById("pw").onblur = ktMKDN;

function dangnhapModal() {
    let acc1 = { nameacc: "TuanDinh22", pass: "2210" };
    let acc2 = { nameacc: "TaiLu", pass: "1234" };
    let ds = [acc1, acc2];

    if (!ktTenAccDN() || !ktMKDN()) {
        return false;
    }
    for (i = 0; i < ds.length; i++) {
        if (document.getElementById("txtTenDN").value == ds[i].nameacc && document.getElementById("pw").value == ds[i].pass) {
            alert("Đăng nhập thành công !");
            // document.getElementById("modalDangnhap").modal("hide"); ko ẩn modal
            $('#modalDangnhap').modal("hide");
            return true;
        }
    }
    alert("Đăng nhập thất bại : tên đăng nhập hoặc mật khẩu không hợp lệ !");
    return false;

    // document.getElementById("modalDangnhap").onclose;
}

///////////////////////////////////////////////////////////////////////////
function ktTenAccDK() {
    let nameacc = document.getElementById("txtTK").value;
    if (nameacc.trim() === '') {
        document.getElementById("spTenDK").innerHTML = "Tên tài khoản đăng ký không được trống !";
        return false;
    }
    document.getElementById("spTenDK").innerHTML = "✔";
    return true;
}

function ktMKDK() {
    let pass = document.getElementById("pwDK").value;
    let regexPass = /^\s*[a-zA-Z0-9,\s]+\s*$/;
    if (pass.trim() === '') {
        document.getElementById("spPassDK").innerHTML = "Mật khẩu không được trống !";
        return false;
    }
    if (!regexPass.test(pass)) {
        document.getElementById("spPassDK").innerHTML = "Mật khẩu không chứa kí tự đặc biệt: {}[]()^$.|*+?\-";
        return false;
    }
    document.getElementById("spPassDK").innerHTML = "✔";
    return true;
}

function ktXacNhanMKDK() {
    let passCheck = document.getElementById("rePass").value;
    if (passCheck.trim() === '') {
        document.getElementById("spRePassDK").innerHTML = "Xác nhận lại mật khẩu !";
        return false;
    }
    if (passCheck != document.getElementById("pwDK").value) {
        document.getElementById("spRePassDK").innerHTML = "Không đúng với mật khẩu đã nhập!";
        return false;
    }
    document.getElementById("spRePassDK").innerHTML = "✔";
    return true;
}

function ktTenDK() {
    let name = document.getElementById("txtHoTen").value;

    if (name.trim() === '') {
        document.getElementById("spNameDK").innerHTML = "Họ tên không được trống !";
        return false;
    }
    document.getElementById("spNameDK").innerHTML = "✔";
    return true;
}

function ktDate() {
    let date = document.getElementById("dateDK").value;
    if (date.trim() === '') {
        document.getElementById("spDate").innerHTML = "Ngày sinh không được trống !";
        return false;
    }
    document.getElementById("spDate").innerHTML = "✔";
    return true;
}

function ktPhoneDK() {
    let phone = document.getElementById("telPhone").value;
    // let regexPhone = /^[0-9]{10}$/;
    let regexPhone = /\+?(0|84)\d{9,10}/;
    if (phone.trim() !== '' && regexPhone.test(phone)) {
        document.getElementById("spPhone").innerHTML = "✔";
        return true;
    }
    document.getElementById("spPhone").innerHTML = "SĐT phải gồm 10 chữ số !";
    return false;
    // let tel = document.getElementById("telPhone").value;
    // let regexTel = /\+?(0|84)\d{9,10}/;
    // if(tel.trim() !== '' && regexTel.test(tel)){
    //     document.getElementById("spPhone")
    // }
    // var phone = $("#telPhone").value();
    // var regexPhone = /\+?(0|84)\d{9,10}/;
    // if(phone.trim !== '' && !regexPhone.text(phone)){
    //     $("spPhone").innerHTML("SĐT phải gồm 10 chữ số");
    //     return false;
    // }
    // $("spPhone").innerHTML("✔");
    // return true;
}

function ktEmailDK() {
    let email = document.getElementById("emailDK").value;
    let regexEmail = /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;
    if (email.trim() === '') {
        document.getElementById("spEmail").innerHTML = "Email không được trống !";
        return false;
    }
    if (!regexEmail.test(email)) {
        document.getElementById("spEmail").innerHTML = "Email không phù hợp !";
        return false;
    }
    document.getElementById("spEmail").innerHTML = "✔";
    return true;
}

///////////////////////////////////////////////////////////////////////////     btn dang nh, dang ky, huy
function dangkyModal() {
    if (!ktTenAccDK() || !ktMKDK() || !ktXacNhanMKDK() || !ktTenDK() || !ktDate() || !ktPhoneDK() || !ktEmailDK())
        return false;
    alert("Đăng ký thành công !");
    return true;
}

///////////////////////////////////////////////////////////////////////////     btn dang nh, dang ky, huy
function huyModal() {
    // xóa trắng form đăng ký
    document.getElementById("txtTK").value = null;
    document.getElementById("pwDK").value = null;
    document.getElementById("rePass").value = null;
    document.getElementById("txtHoTen").value = null;
    document.getElementById("dateDK").value = null;
    document.getElementById("telPhone").value = null;
    document.getElementById("emailDK").value = null;
    document.getElementById("spTenDN").innerHTML = "*";
    document.getElementById("spPass").innerHTML = "*";
    document.getElementById("spTenDK").innerHTML = "*";
    document.getElementById("spPassDK").innerHTML = "*";
    document.getElementById("spRePassDK").innerHTML = "*";
    document.getElementById("spNameDK").innerHTML = "*";
    document.getElementById("spDate").innerHTML = "*";
    document.getElementById("spPhone").innerHTML = "*";
    document.getElementById("spEmail").innerHTML = "*";
    // xóa trắng form đăng nhập
    document.getElementById("txtTenDN").value = null;
    document.getElementById("pw").value = null;
    document.getElementById("spTenDN").innerHTML = "*";
    document.getElementById("spPass").innerHTML = "*";
}

function refreshClock() {
    var d = new Date();
    var s = d.getSeconds();
    var m = d.getMinutes();
    var h = d.getHours();
    var day = d.getDay();
    var date = d.getDate();
    var month = d.getMonth();
    var year = d.getFullYear();
    var days = new Array("Chủ nhật", "Thứ hai", "Thứ ba", "Thứ tư", "Thứ năm", "Thứ sáu", "Thứ bảy");
    var months = new Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12")
    var am_pm;

    if (s < 10) {
        s = "0" + s;
    }
    if (m < 10) {
        m = "0" + m;
    }
    if (h > 12) {
        h -= 12;
        am_pm = "PM";
    } else {
        am_pm = "AM";
    }
    if (h < 10) { h = "0" + h }

    document.getElementById('clock').innerHTML = days[day] + ", " +
        date + "/" + months[month] + "/" + year + ", " + h + ":" + m + ":" + s + " " + am_pm + " | " + "GMT+7";
    setTimeout("refreshClock()", 1000);
}